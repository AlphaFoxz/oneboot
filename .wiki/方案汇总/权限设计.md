# 描述
访问控制策略是指在计算机系统或网络中实施的一种安全机制，用于控制用户或实体对资源的访问权限。访问控制策略定义了谁可以访问什么资源，在什么条件下可以访问以及如何进行访问。
## 3个要素
1. 主体（Subject）：主体是指试图访问资源的用户、进程或实体。主体可以是具体的用户账号、程序、服务等。
2. 资源（Resource）：资源是主体试图访问的对象，可以是文件、数据库、网络服务等。
3. 权限（Permission）：权限是指主体对资源进行的操作或访问的权限，如读取、写入、执行、删除等。
## 2个依据
1. 规则（Rules）：规则定义了访问控制策略的具体规定和条件。规则可以包括角色和权限的分配、访问时间限制、访问来源限制等。
2. 访问策略（Access Policy）：访问策略是指基于规则和权限设置的具体访问控制策略。访问策略可以是基于角色的访问控制（RBAC）、基于属性的访问控制（ABAC）或基于访问控制列表（ACL）等。
## 总结
访问控制策略的目标是确保只有经过授权的主体能够访问其所需的资源，同时防止未经授权的访问和滥用。通过合理设计和实施访问控制策略，可以保护系统和数据的安全性，防止潜在的安全威胁和风险。由上面的要素与依据可知：
1. 权限控制就是3个要素的结果，即：**主体**是否有**权限**操作指定**资源**。
2. **权限**就是已知**主体**和**资源**的前提下，结合**规则**与/或**策略**进行逻辑运算的结果。
# 常见的访问控制方案
## 基于属性的访问控制（Attribute-based access control，ABAC）
可扩展访问控制标记语言 (XACML) 是一种基于 XML 的标准标记语言，用于指定访问控制策略。该标准由 OASIS 发布，定义了声明性细粒度、基于属性的访问控制策略语言、架构和处理模型，描述如何根据策略中定义的规则评估访问请求。
XACML 主要是一个基于属性的访问控制系统。在 XACML 中，属性（有关访问资源的主体、要寻址的资源和环境的信息）充当决定是否授予访问权限的输入。XACML 还可用于实现基于角色的访问控制。
在 XACML 中，要做出的访问控制决定用 "规则 "来表示。每条规则都包含一系列决定是否批准某个请求的条件。如果某条规则适用于某项请求，但规则中的条件无法评估，则结果为 "不确定"。规则在策略中分组，策略集包含策略和可能的其他策略集。每个策略集还包括一个目标（Target），这是一个简单的条件，决定是否要对给定请求进行评估。组合算法可用于以各种方式组合规则和策略，并可能产生不同的结果。XACML 还支持义务和建议表达式。
***XACML 将访问控制功能分离为多个组件。每个使用访问控制的操作环境都有一个策略执行点 (PEP)，它实现要求授权以及授予或拒绝对资源的访问的功能。*** 这些指的是独立于环境的中央策略决策点 (PDP)，它实际上决定是否授予访问权限。 PDP 是指存储在策略检索点(PRP) 中的策略。策略通过策略管理点 (PAP) 进行管理。
实施 ABAC 的关键标准是[XACML](https://en.wikipedia.org/wiki/XACML "XACML") 和 [ALFA (XACML)](https://en.wikipedia.org/wiki/ALFA_(XACML) "ALFA (XACML)")。
从 Windows Server 2012 开始，Microsoft 实施了 ABAC 方法来控制对文件和文件夹的访问。这是通过动态访问控制 (DAC) 和安全描述符定义语言 (SDDL) 来实现的。 SDDL 可以被视为 ABAC 语言，因为它使用用户（声明）和文件/文件夹的元数据来控制访问。
## ~~基于上下文的访问控制（Context-based access control，CBAC）~~
**属于Cisco IOS相关技术**
基于上下文的访问控制（CBAC）是防火墙软件的一项功能，它根据应用层协议会话信息智能过滤 TCP 和 UDP 数据包。它可用于内联网、外联网和互联网。
CBAC 可以配置为仅当连接是从需要保护的网络内部发起时才允许指定的 TCP 和 UDP 流量通过防火墙。 （换句话说，CBAC 可以检查源自外部网络的会话流量。）但是，虽然此示例讨论的是检查源自外部网络的会话流量，但 CBAC 可以检查源自防火墙任一侧的会话流量。 。这是状态检测防火墙的基本功能。
如果没有 CBAC，流量过滤仅限于在网络层或最多传输层检查数据包的访问列表实现。然而，CBAC不仅检查网络层和传输层信息，还检查应用层协议信息（例如FTP连接信息）以了解TCP或UDP会话的状态。这允许支持涉及由于 FTP 控制通道中的协商而创建的多个通道的协议。大多数多媒体协议以及一些其他协议（例如 FTP、RPC 和 SQL*Net）都涉及多个控制通道。
CBAC 检查穿过防火墙的流量以发现和管理 TCP 和 UDP 会话的状态信息。此状态信息用于在防火墙的访问列表中创建临时开口，以允许允许的会话（源自受保护的内部网络内的会话）返回流量和附加数据连接。
CBAC 通过深度数据包检查来工作，因此 Cisco 在其互联网操作系统 (IOS) 中将其称为“IOS 防火墙”。
CBAC 还提供以下好处：
- 拒绝服务预防和检测
- 实时警报和审计跟踪
## 自主访问控制（Discretionary Access Control，DAC）
自主访问控制（Discretionary Access Control，DAC）是这样的一种控制方式，由客体的属主对自己的客体进行管理，由属主自己决定是否将自己的客体访问权或部分访问权授予其他主体，这种控制方式是自主的。也就是说，在自主访问控制下，用户可以按自己的意愿，有选择地与其他用户共享他的文件。
例如：Linux系统的文件
## 基于格（标签）的访问控制（Label-based access control，LBAC）
在计算机安全中，基于格的访问控制（LBAC）是一种复杂的访问控制模型，基于对象（例如资源、计算机和应用程序）和主体（例如个人、群体或组织）之间的任意组合之间的交互。
在这种基于标签的强制访问控制模型中，网格用于定义对象可能具有的安全级别以及主体可以访问的安全级别。只有当主体的安全级别大于或等于客体的安全级别时，才允许主体访问客体。
LBAC 也称为基于标签的访问控制（或基于规则的访问控制）限制，与基于角色的访问控制 (RBAC) 不同。
基于格的访问控制模型首先由 Denning (1976) 正式定义；另见 Sandhu (1993)。
## 以角色为基础的访问控制（Role-based access control，RBAC）
在计算机系统安全领域，基于角色的访问控制（RBAC）或基于角色的安全 是一种限制授权用户访问系统、实施强制访问控制（MAC）或自由访问控制（DAC）的方法。
基于角色的访问控制是一种政策中立的访问控制机制，围绕角色和权限进行定义。角色权限、用户角色和角色角色关系等 RBAC 的组成部分使用户分配变得简单。NIST 的一项研究表明，RBAC 解决了商业和政府组织的许多需求。 RBAC 可用于促进拥有数百个用户和数千个权限的大型组织的安全管理。虽然 RBAC 与 MAC 和 DAC 访问控制框架不同，但它可以不费吹灰之力地执行这些策略。
RBAC 定义了三个主要规则：
1. 角色分配：只有当主体选择或被分配角色时，主体才能行使权限。
2. 角色授权：主体的主动角色必须经过主体的授权。通过上面的规则 1，此规则可确保用户只能承担其被授权的角色。
3. 权限授权：只有对主体的主动角色进行了授权，主体才能行使该权限。通过规则 1 和 2，此规则可确保用户只能行使他们被授权的权限。
还可以应用附加约束，并且可以将角色组合在层次结构中，其中较高级别的角色包含子角色拥有的权限。
借助角色层次结构和约束的概念，我们可以控制RBAC来创建或模拟基于网格的访问控制（LBAC）。因此**RBAC可以被认为是LBAC的超集。**
## 以规则集为基础的访问控制（Rule-set-based access control，RSBAC）
基于规则集的访问控制 (RSBAC) 是针对当前 Linux 内核的开源访问控制框架，自 2000 年 1 月（版本 1.0.9a）以来一直在稳定的生产环境中使用。
RSBAC 的意思是“基于规则集的访问控制”，也是一种基于角色的访问控制（RBAC）解决方案。这两个缩写词可能会引起混淆。
Leonard LaPadula 在他的文章“可信计算机系统的规则集建模”中描述了如何在 UNIX System V 操作系统中实现通用访问控制框架 (GFAC) 方法。他介绍了访问执行工具 (AEF)、具有访问控制规则 (ACR) 的访问决策工具 (ADF) 和访问控制信息 (ACI) 之间的明确分离。
AEF 作为系统调用函数的一部分调用 ADF，ADF 使用 ACI 和规则来返回决策和一组新的 ACI 属性值。然后，该决定由 AEF 强制执行，AEF 还设置新的属性值，并且在允许访问的情况下，提供对主体的对象访问。
然而，RSBAC 带来了自己的挂钩代码，而不是依赖于 Linux 安全模块 ([LSM](https://en.wikipedia.org/wiki/Linux_Security_Modules "Linux Security Modules"))。因此，RSBAC 在技术上是 LSM 本身的替代品，并实现与 SELinux 类似的模块，但具有附加功能。
RSBAC框架包含了完整的对象状态，并且在决策时对内核状态有充分的了解，使其更加灵活和可靠。但是，这是以框架本身的开销稍高为代价的。尽管支持 SELinux 和 RSBAC 的系统对性能有类似的影响，但与单独的 RSBAC 框架相比，单独的 LSM 影响可以忽略不计。
因此，LSM 已被选为 Linux 内核中默认且独特的安全挂钩机制，RSBAC 仅作为单独的补丁提供。
## 强制访问控制mandatory access control(MAC)
采用强制访问控制，该安全策略由安全策略管理员集中控制；用户无法覆盖该策略，例如授予对否则会受到限制的文件的访问权限。相比之下，自主访问控制 (DAC) 还控制主体访问客体的能力，允许用户做出策略决策和/或分配安全属性。 （用户、组和读写执行权限的传统 Unix 系统是 DAC 的一个示例。）启用 MAC 的系统允许策略管理员实施组织范围的安全策略。在 MAC 下（与 DAC 不同），用户无法无意或有意地覆盖或修改此策略。这允许安全管理员定义一个保证（原则上）对所有用户强制执行的中央策略。
## 访问控制列表access control list(ACL)
**存取控制串列**，又称**访问控制表**（Access Control List，ACL），是使用以[访问控制矩阵](https://baike.baidu.com/item/%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E7%9F%A9%E9%98%B5?fromModule=lemma_inlink)为基础的访问控制表，每一个（文件系统内的）对象对应一个串列主体。访问控制表描述用户或系统进程对每个对象的访问控制权限。
访问控制表的主要缺点是不可以有效迅速地枚举一个对象的访问权限。因此，要确定一个对象的所有访问权限需要搜索整个访问控制表来找出相对应的访问权限。
## 基于能力的安全Capability-based security
一个系统只给有对应权限的请求方分配对应资源相关的功能，那么就无需额外存储空间来用于处理权限了。能力即是权限。
例如：
```c++
int fd = open("/etc/passwd", O_RDWR);
```
变量 fd 现在包含进程文件描述符表中文件描述符的索引。该文件描述符是一种能力。它在进程的文件描述符表中的存在足以表明该进程确实具有对该对象的合法访问权限。这种安排的一个关键特征是文件描述符表位于内核内存中，不能由用户程序直接操作。
# 本项目预置系统模块的权限设计
要求：
1. **创建具有访问控制属性的身份**
2. **新资源具有属性、基于属性设置权限**
## 基本规则
- **最小权限原则**，需要什么权限才给什么权限
- 一个用户是一个主体（Subject），一个账号可以有多个用户。默认是单个用户
- 单个表或单行数据都可以成为一个受保护的资源（Resource）
- **组和角色都是一组特定的标签集合**，这两者在权限系统中没有本质区别，但通常组对应的是业务组织架构体系、而角色则可以灵活调配。所以，主体可以通过扮演角色的方式从而获得额外的标签
- 访问控制**是否生效的唯一因素就是资源是否受保护**
## 特殊规则与策略
### 所有权类策略（致敬rust）
受保护的数据只有其拥有者才能对其进行访问、修改。且安全管理员/系统管理员也必须遵守。
原因和对策：  
1、根据以往的开发经验，所有权类型的安全判断是最重要的策略  
2、管理员永远都不应该去操作敏感业务数据，而敏感数据几乎必然是受所有权策略保护的  
3、显然此类策略不利于管理员在特殊情况下对用户的帮助，所以此类策略有时会搭配动态访问授权机制（对应`动态访问控制体系`）进行使用。  
### 业务类策略
顾名思义，我们可以用业务类策略实现用户各种奇怪的权限要求，同时在一定程度上实现了代码逻辑与业务逻辑的统一。
### 动态访问控制体系
动态访问控制（DAC）就是对属性访问控制（ABAC）方案下，一些缺陷的补充。动态访问控制的逻辑很简单：拥有资源的主体允许另一个（或另一类）特定的主体对该资源进行访问、修改。具体表现为：
- 通过**动态访问控制-授权**（DAC Aithorize），一个主体可以扮演另一个主体，授权分为主动和被动。
- 由于业务规则导致的受保护资源被动增删改查，如果当前操作主体没有对应的权限，则必须通过DAC授权的方式扮演为资源拥有者再操作。同时如果DAC授权类型为被动，则必须生成warning级别的日志以记录详细情况。
- 如果安全管理员可以获得用户的动态授权，那么管理员操作敏感数据是可以被容忍的。（实际上是管理员扮演了用户，通过了所有权类型的策略验证，同时利用自己的管理员身份跳过了繁琐的业务类型策略）
### 特殊规则
- 安全管理员和系统管理员在鉴权时可以跳过所有的业务类ABAC策略（ABAC Policy）。
管理员可以跳过业务策略的原因：  
1、“用户需要寻求管理员的帮助，以解决各种系统设计外的特殊问题”这一需求是客观存在、而且难以避免的  
2、管理员难以满足业务策略的要求。但是与此同时：管理员总是会用一个很大的权限去处理数据，而业务策略对正在帮助用户的管理员只有负面效果。

  例1：A表 拥有一个策略：每天只有在9:00-17:00时间段内才允许增删改，那么安全管理员可以无视这个策略，在任何时间都能增删改。
  例2：A表 拥有一个策略：只有每条记录的创建人才可以对记录进行增删改，那么安全管理员将不能无视这个策略。但是安全管理员可以通过DAC授权的方式，扮演这条记录的拥有者（需要拥有者授权），从而对这条记录进行增删改。
